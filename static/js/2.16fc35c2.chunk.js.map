{"version":3,"sources":["components/Button/Button.js","components/hoc/withModal.js","hooks/useInterval.js","components/Trade/Dialog/DepositMargin.js","components/Trade/Position.js","components/Trade/History.js","components/ContractInfo/ContractInfo.js","components/Slider/Slider.js","components/Trade/Trade.js","components/Trade/Dialog/TradeConfirm.js","components/Trade/LiteTrade.js","components/Trade/Dialog/WithdrawMargin.js"],"names":["Button","btnText","className","disabled","click","afterClick","useState","status","setStatus","pending","setPending","loadRef","useRef","onClick","a","current","style","display","ref","marginRight","withModal","Component","appElement","document","getElementById","customizeStyle","overlay","position","zIndex","background","content","border","inset","overflow","props","state","modalIsOpen","this","isOpen","onClose","React","useInterval","callback","delay","savedCallback","useEffect","id","setInterval","clearInterval","DepositMargin","wallet","spec","balance","afterDeposit","integer","setInteger","decimal","setDecimal","amount","setAmount","deposit","depositMargin","detail","chainId","pool","account","res","success","msg","error","errorMessage","message","alert","formatBalance","toFixed","addMarginSub","substring","indexOf","length","splitDecimal","data-dismiss","value","displayType","decimalScale","fontSize","marginLeft","marginTop","bTokenSymbol","type","placeholder","onChange","event","target","DepositDialog","WithDrawDialog","WithdrawMagin","Position","isLiquidation","setIsLiquidation","setPosition","direction","setDirection","balanceContract","setBalanceContract","addModalIsOpen","setAddModalIsOpen","removeModalIsOpen","setRemoveModalIsOpen","setBalance","loadPositionInfo","isConnected","getPositionInfo","positionInfo","volume","margin","unrealizedPnl","loadBalance","getWalletBalance","onClosePosition","closePosition","finally","directionClass","role","aria-hidden","t","viewBox","version","xmlns","p-id","width","height","d","fill","averageEntryPrice","transform","data-name","marginHeld","liquidationPrice","afterWithdraw","DeriEnv","get","History","specs","history","setHistory","loadHistory","getTradeHistory","all","his","map","item","directionText","find","s","baseToken","baseTokenText","symbol","v-show","index","rel","alt","src","dateFormat","asString","Date","parseInt","time","price","notional","transactionFee","ContractInfo","bSymbol","multiplier","fundingRateCoefficient","minInitialMarginRatio","minMaintenanceMarginRatio","feeRatio","contract","setContract","setSpec","getSpecification","contractInfo","suffix","Handle","RcSlider","handle","dragging","restProps","prefixCls","placement","visible","overlayStyle","overlayInnerStyle","color","boxShadow","Slider","max","start","onValueChange","freeze","limit","setLimit","setValue","setDisabled","marks","setMarks","isNaN","mark","per","i","top","left","paddingRight","min","step","Trade","onSpecChange","indexPrice","setContractInfo","dropdown","setDropdown","setMargin","fundingRate","setFundingRate","fundingRateTip","setFundingRateTip","fundingRateAfter","setFundingRateAfter","transFee","setTransFee","poolLiquidity","setPoolLiquidity","liqUsedPair","setLiqUsedPair","indexPriceClass","setIndexPriceClass","setFreeze","indexPriceRef","tradeInfo","setTradeInfo","setVolume","loadPosition","directionClazz","classNames","selectClass","volumeClazz","hasSpec","hasConnectWallet","directionChange","onDropdown","stopPropagation","loadFundingRate","getFundingRate","fundingRate0","tip","fundingRatePerBlock","liquidity","loadContractInfo","loadTransactionFee","getEstimatedFee","Math","abs","calcLiquidityUsed","getLiquidityUsed","curLiqUsed","getEstimatedLiquidityUsed","afterLiqUsed","liquidityUsed0","liquidityUsed1","calcFundingRateAfter","getEstimatedFundingRate","fundingRate1","initialzie","address","priceCache","clear","update","PerpetualPoolParametersCache","refreshCache","bodyClickListener","body","addEventListener","removeEventListener","currentPosition","contractValue","dynamicBalance","leverage","available","converted","calcTradeInfo","number","floor","cloned","config","e","select","selected","onSelect","title","onFocus","setAttribute","onBlur","onKeyUp","test","allowNegative","prefix","unit","Operator","afterTrade","ConfirmDialog","trade","tradeWithMargin","afterTradePosition","v-if","isApprove","setIsApprove","noBalance","setNoBalance","emptyVolume","setEmptyVolume","setModalIsOpen","loadApprove","isUnlocked","catch","console","log","result","actionElement","undefined","unlock","connect","LiteTrade","isPro","curTab","setCurTab","switchTab","tradeClassName","calculateBalance","withdraw","withdrawMargin","thousandSeparator"],"mappings":"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","file":"static/js/2.16fc35c2.chunk.js","sourcesContent":["import {useState,useRef} from 'react';\nexport default function Button({btnText,className,disabled,click,afterClick}){\n  const [status, setStatus] = useState(disabled ? 'disabled' : 'enabled');\n  const [pending, setPending] = useState(false);\n  const loadRef = useRef(null)\n\n  const onClick = async () => {\n    if(status !== 'enabled') {\n      return ;\n    }\n    setStatus('disabled')\n    setPending(true);\n    loadRef.current && (loadRef.current.style.display = 'inline-block')\n    const result = await click();    \n    if(result){\n      afterClick && afterClick()\n    } \n    loadRef.current && (loadRef.current.style.display = 'none')\n    setStatus('enabled')\n    setPending(false);\n  }\n\n  return(\n    <button className={className} onClick={onClick} >\n        <span className='btn-loading-wrap'>\n          <span ref={loadRef}\n            className='spinner spinner-border spinner-border-sm'\n            style={{display : 'none' ,marginRight : '2'}}>\n          </span>\n        </span>\n          {pending ? 'PENDING' : btnText  }\n        </button>\n  )\n}","import React from 'react'\nimport Modal from 'react-modal/lib/components/Modal';\n\nconst withModal = Component => {\n  const appElement = document.getElementById('root')\n  const customizeStyle =  {\n    overlay: {\n      position: 'fixed',\n      zIndex : 2,\n      background : 'rgb(0 0 0 / 0.5)'\n    },\n    content: {\n      position: 'absolute',\n      border : 0,\n      background : 'none',\n      inset : 0,\n      overflow : 'initial'\n    }\n  };\n\n  class WithModal extends React.Component {\n    constructor(props){\n      super(props)\n      this.state = {\n        modalIsOpen : false\n      }\n    }\n\n    render(){\n      const {modalIsOpen} = this.props\n      return (\n        <Modal isOpen={modalIsOpen} style={customizeStyle} appElement={appElement}>\n          <Component {...this.props} onClose={this.props.onClose}/>\n        </Modal>\n      )\n    }\n  }\n\n  return WithModal;\n}\nexport default withModal;","import { useRef,useEffect } from 'react'\n\nexport default function useInterval(callback,delay){\n  const savedCallback = useRef(callback)\n\n  useEffect(() => {\n    savedCallback.current = callback\n  }, [callback])\n\n  useEffect(() => {\n    if (delay === null) {\n      return\n    }\n\n    const id = setInterval(() => savedCallback.current(), delay)\n\n    return () => clearInterval(id)\n  }, [delay])\n}","import React, { useState ,useEffect} from 'react'\nimport {  getWalletBalance, depositMargin } from \"../../../lib/web3js\";\nimport NumberFormat from 'react-number-format';\nimport Button from '../../Button/Button';\n\nexport default function DepositMargin({wallet,spec = {},onClose,balance,afterDeposit}){\n  const [integer, setInteger] = useState('');\n  const [decimal, setDecimal] = useState('');\n  const [amount,setAmount] = useState('');\n\n  const onChange = event => {\n    const {value} = event.target\n    setAmount(value)\n  }\n\n  const addAll = () => {\n    setAmount(balance)\n  }\n\n  const deposit = async (amount) => {\n    const res = await depositMargin(wallet.detail.chainId,spec.pool,wallet.detail.account,amount);\n    if(res.success){\n      afterDeposit();\n      onClose();\n    } else {\n      const msg = typeof res.error === 'string' ? res.error : res.error.errorMessage || res.error.message\n      alert(msg)\n    }\n  }\n\n  const splitDecimal = () => {\n    if(balance){\n      const formatBalance = (+balance).toFixed(2)\n      const addMarginSub = formatBalance.substring(formatBalance.indexOf('.') + 1,formatBalance.length)\n      setInteger(balance);\n      setDecimal(addMarginSub)\n    }\n  }\n\n  useEffect(() => {\n    splitDecimal();\n    return () => {\n    };\n  }, [balance]);\n\n\n  return (\n    <div className='modal fade'>\n      <div className='modal-dialog'>\n        <div className='modal-content'>\n          <div className='modal-header'>\n            <div className='title'>DEPOSIT MARGIN</div>\n            <div className='close' data-dismiss='modal' onClick={onClose}>\n              <span>&times;</span>\n            </div>\n          </div>\n          <div className='modal-body'>\n            <div className='margin-box-info'>\n              <div>Wallet Balance</div>\n              <div className='money'>\n                <span>\n                  <span className='bt-balance'>\n                    <NumberFormat value={ integer } displayType = 'text' decimalScale={0}/>.<span style={{fontSize:'12px'}}>{decimal}</span> \n                  </span> \n                  <br/>\n                  <span \n                  style={{fontSize :'14px',marginLeft: '10px',marginTop: '10px'}}>\n                    {spec.bTokenSymbol}\n                  </span>\n                  </span\n                >\n                <span className='add'></span>\n              </div>\n              <div className='enter-margin'>\n                <div className='input-margin'>\n                  <div className='box'>\n                    <div className='amount' style={{display : amount !=='' ? 'block' : 'none'}}>AMOUNT</div>\n                    <input\n                      type='number'\n                      className='margin-value'\n                      placeholder='Amount'\n                      value={amount}\n                      onChange={onChange}\n                    />\n                  </div>\n                </div>\n                <div>{ spec.bTokenSymbol }</div>\n              </div>\n              <div className='max'>\n                MAX: <span className='max-num'>{ balance }</span>\n                <span className='max-btn-left' onClick={addAll} >ADD ALL</span>\n              </div>\n              <div className='add-margin-btn'>\n                <Button\n                  className='margin-btn'\n                  btnText='DEPOSIT'\n                  click={() => deposit(amount)}\n                />                  \n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","import React, { useState ,useEffect} from 'react'\nimport NumberFormat from 'react-number-format';\nimport { getPositionInfo, closePosition, getWalletBalance } from \"../../lib/web3js\";\nimport className from 'classnames'\nimport withModal from '../hoc/withModal';\nimport DepositMargin from './Dialog/DepositMargin';\nimport WithdrawMagin from './Dialog/WithdrawMargin';\nimport useInterval from '../../hooks/useInterval';\n\n\n\nconst DepositDialog = withModal(DepositMargin);\nconst WithDrawDialog = withModal(WithdrawMagin)\n\nexport default function Position({wallet,spec = {}}){\n  const [isLiquidation, setIsLiquidation] = useState(false);\n  const [position, setPosition] = useState({});\n  const [direction, setDirection] = useState('');\n  const [balanceContract, setBalanceContract] = useState('');\n  const [addModalIsOpen, setAddModalIsOpen] = useState(false);\n  const [removeModalIsOpen, setRemoveModalIsOpen] = useState(false);\n  const [balance, setBalance] = useState('');\n  useInterval(loadPositionInfo,3000)\n\n  async function loadPositionInfo() { \n    if(wallet.isConnected() && spec && spec.pool){\n      const positionInfo = await getPositionInfo(wallet.detail.chainId,spec.pool,wallet.detail.account)\n      if(positionInfo){\n        setPosition(positionInfo);\n        const direction = (+positionInfo.volume) > 0 ? 'LONG' : (positionInfo.volume == 0 ? '--' : 'SHORT') \n        setDirection(direction)      \n        setBalanceContract((+positionInfo.margin) + (+positionInfo.unrealizedPnl))\n      }\n    }    \n  }\n\n  const loadBalance = async () => {\n    if(wallet.isConnected()){\n      const balance = await getWalletBalance(wallet.detail.chainId,spec.pool,wallet.detail.account)\n      if(balance){\n        setBalance(balance)\n      }\n    }\n  }\n\n  //平仓\n  const onClosePosition = async () => {\n    setIsLiquidation(true)\n    const res = await closePosition(wallet.detail.chainId,spec.pool,wallet.detail.account).finally(() => setIsLiquidation(false))\n    if(res.success){\n      loadPositionInfo();\n    } else {      \n      if(typeof res.error === 'string') {\n        alert(res.error || 'Liquidation failed')\n      } else if(typeof res.error === 'object'){\n        alert(res.error.errorMessage || 'Liquidation failed')\n      }\n      \n    }\n  }\n\n  const afterDeposit = () => {\n    setAddModalIsOpen(false)\n    loadPositionInfo();\n  }\n\n  const onCloseDeposit = () => {\n    setAddModalIsOpen(false)\n  }\n\n  const afterWithdraw = () => {\n    setRemoveModalIsOpen(false)\n    loadPositionInfo();\n  }\n\n  const onCloseWithdraw = () => {\n    setRemoveModalIsOpen(false)\n  }\n\n  const directionClass = className('Direction','info-num',{\n    'LONG' : direction === 'LONG',\n    'SHORT' : direction === 'SHORT'\n  })\n\n\n\n  useEffect(() => {\n    loadPositionInfo();\n    loadBalance();\n    return () => {\n    };\n  }, [wallet.detail.account,spec.pool]);\n\n   \n  \n  return(\n\n    <div className='position-info'>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Position</div>\n        <div className='info-num'>{ position.volume}</div>\n      </div>\n      <div className='info-right'>\n        <div\n          className='close-position'\n          id='close-p'\n          onClick={onClosePosition}\n        >\n          <span\n            className='spinner spinner-border spinner-border-sm'\n            role='status'\n            aria-hidden='true'\n            style={{display: isLiquidation ? 'block' : 'none'}}\n          ></span>\n          <svg t='1618369709897' className='icon' viewBox='0 0 1024 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='2009' width='14' height='14'><path d='M510.8096 420.3008l335.296-335.296 90.5088 90.5088-335.296 335.296 335.296 335.296-90.5088 90.5088-335.296-335.296-335.296 335.296-90.5088-90.5088 335.296-335.296-335.296-335.296 90.5088-90.5088z' p-id='2010' fill='#ffffff'></path></svg> Close\n        </div>\n      </div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Average Entry Price</div>\n        <div className='info-num'><NumberFormat value={ position.averageEntryPrice } decimalScale={2} displayType='text'/></div>\n      </div>\n      <div className='info-right'></div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text balance-con'>\n          Balance in Contract\n          (Dynamic Balance)\n        </div>\n        <div className='info-num'> <NumberFormat decimalScale = {2} value={ balanceContract} displayType='text' /></div>\n      </div>\n      <div className='info-right'>\n        <div\n          className='add-margin'\n          id='openAddMargin'\n          onClick={() => setAddModalIsOpen(true)}\n        >\n          <svg\n            className='svg'\n            xmlns='http://www.w3.org/2000/svg'\n            width='18'\n            height='18'\n            viewBox='0 0 18 18'\n          >\n            <path\n              id='login'\n              d='M13,9,7,4V7H0v4H7v3Zm3,7H8v2h8a2.006,2.006,0,0,0,2-2V2a2.006,2.006,0,0,0-2-2H8V2h8Z'\n              transform='translate(18) rotate(90)'\n              fill='#3ebf38'\n            />\n          </svg>\n          Add\n        </div>\n        <div\n          className='remove-margin'\n          onClick={() => setRemoveModalIsOpen(true)}\n        >\n          <svg\n            className='svg'\n            xmlns='http://www.w3.org/2000/svg'\n            width='18'\n            height='18'\n            viewBox='0 0 18 18'\n          >\n            <path\n              id='log-out'\n              data-name='log out'\n              d='M18,9,12,4V7H5v4h7v3ZM2,2h8V0H2A2.006,2.006,0,0,0,0,2V16a2.006,2.006,0,0,0,2,2h8V16H2Z'\n              transform='translate(0 18) rotate(-90)'\n              fill='#e35061'\n            />\n          </svg>\n          Remove\n        </div>\n      </div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Direction</div>\n        <div className={directionClass} >{direction}</div>\n      </div>\n      <div className='info-right'></div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Margin</div>\n        <div className='info-num'><NumberFormat value={ position.marginHeld } displayType='text' decimalScale={2}/></div>\n      </div>\n      <div className='info-right'></div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Unrealized PnL</div>\n        <div className='info-num'><NumberFormat value={ position.unrealizedPnl } displayType='text' decimalScale={8}/></div>\n      </div>\n      <div className='info-right'></div>\n    </div>\n    <div className='info'>\n      <div className='info-left'>\n        <div className='title-text'>Liquidation Price</div>\n        <div className='info-num'><NumberFormat decimalScale = {2} value={position.liquidationPrice} displayType='text'/></div>\n      </div>\n      <div className='info-right'></div>\n    </div>\n    <DepositDialog\n       wallet={wallet}\n       modalIsOpen={addModalIsOpen} \n       onClose={onCloseDeposit}\n       spec={spec}\n       afterDeposit={afterDeposit}\n       balance={balance}\n    />\n    <WithDrawDialog\n      wallet={wallet}\n      modalIsOpen={removeModalIsOpen} \n      onClose={onCloseWithdraw}\n      spec={spec}\n      afterWithdraw={afterWithdraw}\n      position={position}\n      />\n  </div>\n  )\n}","import React, { useState ,useEffect} from 'react'\nimport { getTradeHistory,DeriEnv } from \"../../lib/web3js\";\nimport dateFormat from 'date-format'\nimport NumberFormat from 'react-number-format';\nimport useInterval from '../../hooks/useInterval';\nimport config from '../../config.json'\nimport classNames from 'classnames';\n\nconst chainConfig = config[DeriEnv.get()]['chainInfo'];\n\nexport default function History({wallet = {},spec ={} ,specs = []}){\n  const [history, setHistory] = useState([]);\n  \n\n  const loadHistory =  async () => {\n    const all = await getTradeHistory(wallet.detail.chainId,spec.pool,wallet.detail.account)\n    const his = all.map(item => {\n      item.directionText = item.direction === 'LONG' ? 'LONG / BUY' : 'SHORT / SELL'\n      const find = specs.find(s => s.bTokenSymbol === item.baseToken)\n      if(find){\n        item.baseTokenText = ` ${find.symbol} / ${find.bTokenSymbol}`\n      }\n      return item;\n    })\n    setHistory(his)\n  }\n\n  const showTxBar = e => {\n    const target = e.target;\n    target.parentElement.previousElementSibling.style.display = 'block'\n    // const sibling  = target.parent.previousElementSibling;\n    // sibling.setAttribute('display','block')\n  }\n\n  const hideTxBar = e => {\n    const target = e.target;\n    const sibling  = target.previousElementSibling;\n    sibling.setAttribute('display','none')\n  }\n\n\n  // useInterval(loadHistory,3000)\n  useEffect(() => {\n    loadHistory();\n    return () => {      \n    };\n  }, [wallet.detail,spec.pool,specs]);\n  \n  return (\n    <div className='history-info' v-show='historyShow'>\n      {history.map((his,index) => {\n        return (\n          <div className='history-box' key={index}>\n          <div className='direction-bToken-price'>\n            <span className='direction'>\n              <span className={`${his.direction}`}>{ his.directionText }</span>\n              <span>{ his.baseTokenText }</span>              \n              <span className='view-arrow' >\n                {/* <span className='view-space' onMouseOut={hideTxBar}><a href={`${chainConfig[wallet.detail.chainId]['viewUrl']}/tx/${his.transactionHash}`}>view at {chainConfig[wallet.detail.chainId]['viewUrl']}</a></span><span class=\"right-arrow\"></span>               */}\n                <img rel='noreferrer' alt='' src=\"data:image/svg+xml;base64,DQo8c3ZnIGZpbGw9Im5vbmUiIGhlaWdodD0iMTAiIHdpZHRoPSIxMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNOC42NzYuNjQyYS42NS42NSAwIDAwLS4wNzIuMDA2SDQuNzkzYS42NS42NSAwIDAwLS41Ny45NzUuNjUuNjUgMCAwMC41Ny4zMjJINy4xMkwuNDM4IDguNjE0YS42NDcuNjQ3IDAgMDAuMjg2IDEuMDk2LjY1LjY1IDAgMDAuNjMyLS4xNzlMOC4wNCAyLjg2MXYyLjMyNGEuNjQ4LjY0OCAwIDAwLjk3Ny41Ny42NDguNjQ4IDAgMDAuMzIyLS41N1YxLjM4YS42NDcuNjQ3IDAgMDAtLjY2Mi0uNzM3eiIgZmlsbD0iI0FBQUFBQSIvPg0KPC9zdmc+DQoNCg==\"/>\n              </span>\n            </span>\n            <span className='history-text time'>{dateFormat.asString('yyyy-MM-dd hh:mm:ss',new Date(parseInt(his.time)))}</span>\n          </div>\n          <div className='time-price-volume'>\n            <div className='history-price'>\n              <div className='history-title'>Volume @ Price</div>\n              <div className='history-text'>{ his.volume } @ <NumberFormat value={ his.price } decimalScale={2} displayType='text'/></div>\n            </div>\n          <div className='notional'>\n              <div className='history-title'>Notional</div>\n              <div className='history-text'>{ his.notional }</div>\n            </div>\n            <div className='history-fee'>\n              <div className='history-title'>Transaction Fee</div>\n              <div className='history-text'>{ his.transactionFee }</div>\n            </div>\n          </div>        \n        </div>\n        )\n      })}\n    </div>\n  )\n}","import React, { useState,useEffect} from 'react'\nimport NumberFormat from 'react-number-format'\nimport { getSpecification } from '../../lib/web3js';\n\n\nexport default function ContractInfo({wallet,spec ={}}){\n  const [contract, setContract] = useState({\n    bSymbol : 'USDT',\n    symbol : 'BTCUSD',\n    multiplier : '0.0001',\n    fundingRateCoefficient : '0.0000025',\n    minInitialMarginRatio : 0.1,\n    minMaintenanceMarginRatio : 0.0005,\n    feeRatio : 0.05\n  }); \n\n  useEffect(() => { \n    const setSpec = async () => {           \n      if(spec.pool && wallet.isConnected()){\n        const contractInfo = await getSpecification(wallet.detail.chainId,spec.pool,wallet.detail.account) \n        setContract(contractInfo)  \n      }\n    }\n    wallet && setSpec();\n    return () => {};\n  }, [spec,wallet]);\n  \n  return(\n    <div className=\"contract-box\">\n      <div className='contract-header'></div>\n      <div className=\"contract-info\">\n        <div className=\"conntract-header\">CONTRACT INFO</div>\n        <div className=\"info\">\n          <div className=\"title\">Base Token</div>\n          <div className=\"text\">\n            { contract.bSymbol }\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Symbol</div>\n          <div className=\"text\">\n            { contract.symbol }\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Multiplier</div>\n          <div className=\"text\">\n            { contract.multiplier }\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Funding Rate Coefficient</div>\n          <div className=\"text\">\n            { contract.fundingRateCoefficient }\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Min Initial Margin Ratio</div>\n          <div className=\"text\">\n            <NumberFormat displayType='text' value ={ contract.minInitialMarginRatio * 100 } decimalScale={2} suffix='%'/>\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Min Maintenance Margin Ratio</div>\n          <div className=\"text\">\n            <NumberFormat displayType='text' value ={ contract.minMaintenanceMarginRatio * 100 } decimalScale={2} suffix='%'/>\n          </div>\n        </div>\n        <div className=\"info\">\n          <div className=\"title\">Transaction Fee</div>\n          <div className=\"text\">\n            <NumberFormat displayType='text' value ={ contract.feeRatio * 100 } decimalScale={2} suffix='%'/>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","import React, { useState,useEffect } from 'react'\nimport RcSlider,{SliderTooltip} from 'rc-slider'\nimport 'rc-slider/assets/index.css';\nimport './slider.less'\nconst { Handle } = RcSlider;\n\n\n function handle(props){\n  const { value, dragging, index, ...restProps } = props;\n  return (\n    <SliderTooltip\n      prefixCls=\"rc-slider-tooltip\"\n      overlay={!!value ? value : ''}\n      placement=\"top\"\n      key={index}\n      visible={!!value ? true : false}\n      overlayStyle={{display : 'block'}}\n      overlayInnerStyle={{color : '#569BDA',background : 'none',display : 'block' ,fontSize : '10px',boxShadow : 'none'}}\n    >\n      <Handle value={value} {...restProps} />\n    </SliderTooltip>\n  );\n};\n\n\nexport default function Slider({max,start,onValueChange,freeze}){\n  const [limit, setLimit] = useState(0);\n  const [value, setValue] = useState(0);\n  const [disabled, setDisabled] = useState(false);\n  const [marks, setMarks] = useState({});\n\n  const onSliderChange = value => {\n    setValue(value)\n    onValueChange(value);\n  }\n\n  useEffect(() => {\n    setDisabled(freeze)\n    return () => { };\n  }, [freeze]);\n\n  useEffect(() => {\n    if(isNaN(max)){\n      setLimit('')\n    }  else {\n      if((+max) > 0){\n        setDisabled(false)\n      } else {\n        setDisabled(true)\n      }\n      const mark = {\n      };\n      const per = (+max) / 10\n      for(let i = 0 ; i<=10 ; i++){\n        if(i === 0 || i ===10 ){\n          const style = {top: '-16px',position: 'relative'}\n          if(i ===10){\n            style.width = 100;\n            style.left = '-10px'\n            style.paddingRight = '10px'            \n          }\n          mark[i*per] = <><div style={style}>{i === 10 ? (i*per).toFixed(2) : i * per}</div><div style={{top: '-16px',position: 'relative'}}>l</div></>\n        } else{\n          mark[i*per] = 'l'\n        }\n        \n      }\n      setMarks(mark);\n      setLimit(+max)\n    }\n\n    return () => {};\n  }, [max]);\n\n  useEffect(() => {\n    if(isNaN(start)){\n      setValue(0)\n    } else {\n      setValue(start)\n    }\n    return () => {      \n    };\n  }, [start]);\n\n  return (\n      <RcSlider\n        handle={handle}\n        className='deri-slider' \n        start={start}\n        min={0}\n        max={limit}\n        value={value}\n        onChange={onSliderChange}\n        disabled={disabled}\n        overlay={value}\n        step={0.01}\n        marks={marks}\n       >\n      </RcSlider>\n  )\n}","import { useState,useEffect,useRef } from 'react'\nimport classNames from \"classnames\";\nimport Slider from '../Slider/Slider';\nimport Button from '../Button/Button';\nimport {priceCache,PerpetualPoolParametersCache, isUnlocked,unlock, DeriEnv, deriToNatural, getFundingRate, getUserWalletBalance, getWalletBalance, getPositionInfo, getSpecification, getEstimatedFee, getLiquidityUsed, hasWallet, getEstimatedLiquidityUsed, getEstimatedFundingRate} from '../../lib/web3js/index'\nimport NumberFormat from 'react-number-format';\nimport withModal from '../hoc/withModal';\nimport TradeConfirm from './Dialog/TradeConfirm';\nimport DepositMargin from './Dialog/DepositMargin'\nimport useInterval from '../../hooks/useInterval';\n\n\n\n\nexport default function Trade({wallet = {},spec = {}, specs = [],onSpecChange,indexPrice}){\n  const [direction, setDirection] = useState('long');\n  const [contractInfo, setContractInfo] = useState(null);\n  const [dropdown, setDropdown] = useState(false);  \n  const [margin, setMargin] = useState('0.00');  \n  const [position, setPosition] = useState({});\n  const [fundingRate, setFundingRate] = useState('0.00');\n  const [fundingRateTip, setFundingRateTip] = useState('');\n  const [fundingRateAfter, setFundingRateAfter] = useState('');\n  const [transFee, setTransFee] = useState('');\n  const [poolLiquidity, setPoolLiquidity] = useState('');\n  const [liqUsedPair, setLiqUsedPair] = useState({});\n  const [indexPriceClass, setIndexPriceClass] = useState('');\n  const [freeze, setFreeze] = useState(false);\n  const indexPriceRef = useRef();\n  \n\n  //交易信息\n  const [tradeInfo, setTradeInfo] = useState({});\n  //控制状态\n  const [volume, setVolume] = useState('');  \n\n  useInterval(loadPosition,3000)\n\n  const directionClazz = classNames('checked-long','check-long-short',' long-short',{' checked-short' : direction === 'short'})\n  const selectClass = classNames('dropdown-menu',{'show' : dropdown})\n  const volumeClazz = classNames('contrant-input',{'inputFamliy' : volume !== ''})\n\n  //是否有 spec\n  const hasSpec = () => spec && spec.pool\n\n  //是否有链接钱包\n  const hasConnectWallet = () => wallet && wallet.detail && wallet.detail.account\n\n  const directionChange = direction => {\n    setVolume('')\n    setDirection(direction)\n  }\n\n  const onDropdown = (event) => {\n    if(specs.length > 0){\n      event.stopPropagation();\n      setDropdown(!dropdown)    \n    }\n  }\n\n  //切换交易标的\n  const onSelect = select => {\n    const selected = specs.find(config => config.symbol === select.symbol )    \n    setFreeze(true)\n    onSpecChange(selected);\n    setVolume('')\n    setFreeze(false)\n  }\n\n  const onSlide = value => {    \n    setMargin(value);\n  }\n\n  //refresh cache\n  const refreshCache = () => {\n    if(hasConnectWallet() && hasSpec()){\n      const {chainId,account} = wallet.detail;\n      const address = spec.pool\n      priceCache.clear();\n      priceCache.update(chainId,address);\n      PerpetualPoolParametersCache.update(chainId,address,account);\n    }\n  }\n\n\n  //资金费率\n  const loadFundingRate = async () => {\n    if(hasConnectWallet() && hasSpec()){    \n      const res = await getFundingRate(wallet.detail.chainId,spec.pool)\n      if(res){\n        setFundingRate(res.fundingRate0)\n        const tip = `Funding  Rate (per block) = ${res.fundingRatePerBlock}` +\n        `\\n(1 Long contract pays 1 short contract ${res.fundingRatePerBlock} ${spec.bTokenSymbol} per block)`\n        setFundingRateTip(tip);\n        setPoolLiquidity(res.liquidity)\n      }\n    }\n  }\n\n\n  //当前仓位\n  async function loadPosition() {\n    if(hasConnectWallet() && hasSpec()) {\n      const position = await getPositionInfo(wallet.detail.chainId,spec.pool,wallet.detail.account);\n      if(position){\n        setPosition(position);        \n      }\n    }\n  }\n\n  //价值合同信息\n  const loadContractInfo = async () => {\n    if(hasConnectWallet() && hasSpec()){\n      const contractInfo = await getSpecification(wallet.detail.chainId,spec.pool,wallet.detail.account);      \n      setContractInfo(contractInfo)      \n    }\n  }\n\n  //交易费用\n  const loadTransactionFee = async () => {\n    if(hasConnectWallet() && hasSpec()) {\n      const transFee = await getEstimatedFee(wallet.detail.chainId,spec.pool,Math.abs(volume));\n      setTransFee(transFee);\n    }\n  }\n\n  //计算流动性的变化\n  const calcLiquidityUsed = async () => {\n    if(hasConnectWallet() && hasSpec()) {\n      const {detail} = wallet\n      const curLiqUsed = await getLiquidityUsed(detail.chainId,spec.pool)\n      const afterLiqUsed = await getEstimatedLiquidityUsed(detail.chainId,spec.pool,volume)\n      if(curLiqUsed && afterLiqUsed){\n        setLiqUsedPair({curLiqUsed : curLiqUsed.liquidityUsed0,afterLiqUsed : afterLiqUsed.liquidityUsed1})\n      }\n    }\n  }\n\n  //计算funding rate的变化\n  const calcFundingRateAfter = async () => {\n    if(hasConnectWallet() && hasSpec()){\n      const fundingRateAfter = await getEstimatedFundingRate(wallet.detail.chainId,spec.pool,volume);\n      if(fundingRateAfter){\n        setFundingRateAfter(fundingRateAfter.fundingRate1);\n      }\n    }\n  }\n\n\n  //处理输入相关方法\n  const onFocus = event => {\n    const target =event.target;\n    target.setAttribute('class','contrant-input inputFamliy')\n  }\n\n  const onBlur = event => {\n    const target =event.target;\n    if(target.value === '') {\n      target.setAttribute('class','contrant-input')\n    }    \n  }\n\n  const onKeyUp = event => {\n    return event.target.value !== '' && /^\\d*\\.?\\d*$/.test(event.target.value)\n  }\n\n  //完成交易\n  const afterTrade = () => {\n    setVolume('')\n    loadPosition();\n  }\n\n\n  const initialzie = () => {    \n    refreshCache(); //refresh cache\n    loadFundingRate(); // funding rate changed\n    loadPosition() // balance in contract changed\n    loadContractInfo(); //contract info change    \n  }\n\n  //计算交易相关数据（dynamic balance、margin、available balance)\n  const calcTradeInfo = () => {\n    if(position && contractInfo && indexPrice) {\n      const currentPosition = (+volume) + (+position.volume)\n      const contractValue = Math.abs(currentPosition) * indexPrice.index * contractInfo.multiplier;\n      const dynamicBalance = ((+position.margin) + (+position.unrealizedPnl)).toFixed(2)\n      const margin = (contractValue * contractInfo.minInitialMarginRatio).toFixed(2);\n      const leverage = (+contractValue / +dynamicBalance).toFixed(1);\n      const available = (+dynamicBalance) - (+margin)\n      const converted = contractValue / indexPrice.index\n      const tradeInfo = {\n        volume,         //合约数量\n        dynamicBalance, //动态余额\n        margin,         //存入保证金\n        marginHeld : position.marginHeld ,//冻结保证金 \n        available,      //可用余额\n        converted,      //换算的值\n        leverage,        //杠杆\n      }\n      setTradeInfo(tradeInfo);\n    }\n  }\n\n  //spec select hide listener\n  useEffect(() => {\n    const bodyClickListener = document.body.addEventListener('click',() => setDropdown(false),false)\n    return () => {\n      document.body.removeEventListener('click',bodyClickListener)\n    }\n  }, []);\n\n  //spec --> price index --> funding rate --> balance -->  contract info\n  useEffect(() => {\n    initialzie();\n    return () => {\n    };\n  }, [wallet.detail,spec]);\n\n\n  useEffect(() => {\n    calcTradeInfo()\n    if(indexPriceRef.current){\n      setIndexPriceClass(indexPriceRef.current > indexPrice.index ? 'fall' : 'rise')\n    }\n    indexPriceRef.current = indexPrice.index;\n    return () => {\n    };\n  }, [position.unrealizedPnl,position.volume,indexPrice.index,volume]);\n\n  useEffect(() => {\n    calcFundingRateAfter();\n    calcLiquidityUsed();\n    loadTransactionFee();\n    return () => {      \n    };\n  }, [volume]);\n\n\n  useEffect(() => {    \n    if(contractInfo){\n      const volume = (+margin) / ((+indexPrice.index) * (+contractInfo.multiplier) * (+contractInfo.minInitialMarginRatio)) - (+position.volume)\n      if(!isNaN(volume)){\n        const number = Math.floor(volume);\n        if((number) >= 0){\n          setDirection('long')\n        } else {\n          setDirection('short')\n        }\n        const cloned = {...tradeInfo}\n        cloned.volume = number;\n        setTradeInfo(cloned)\n        setVolume(number);\n      }\n    }\n    return () => {      \n    };\n  }, [margin]);\n\n\n   \n  return (\n    <div className='trade-info'>\n    <div className='trade-peration'>\n      <div className='check-baseToken'>\n        <div className='btn-group check-baseToken-btn'>\n          <button\n            type='button'\n            onClick={onDropdown}\n            className='btn chec'>\n            {spec.symbol} / {spec.bTokenSymbol} (10X)\n            <span\n              className='check-base-down' onClick={onDropdown}\n            ><svg\n              t='1616752321986'\n              className='icon'\n              viewBox='0 0 1024 1024'\n              version='1.1'\n              xmlns='http://www.w3.org/2000/svg'\n              p-id='1700'\n              width='16'\n              height='16'\n            >\n                <path\n                  d='M843.946667 285.866667L512 617.386667 180.053333 285.866667 119.893333 346.026667l331.946667 331.946666L512 738.133333l392.106667-392.106666-60.16-60.16z'\n                  p-id='1701'\n                  fill='#cccccc'\n                ></path></svg>\n              </span>\n          </button>\n          <div className={selectClass}>\n            <div className='dropdown-box'>\n              {specs.map((config,index) => {\n                return (\n                  <div className='dropdown-item' key={index} onClick={(e) => onSelect(config)}>              \n                    {config.symbol} / {config.bTokenSymbol} (10X)\n                  </div>\n                )\n              })}\n            </div>\n            \n          </div>\n        </div>\n\n        <div className='price-fundingRate pc'>\n          <div className='index-prcie'>\n            Index Price: <span className={indexPriceClass}>&nbsp; <NumberFormat value={indexPrice.index} displayType='text'/></span>\n          </div>\n          <div className='funding-rate'>\n            <span>Funding Rate Annual: &nbsp;</span>\n            <span className='funding-per' title={fundingRateTip}>{ fundingRate }</span> \n          </div>\n        </div>\n        <div className='price-fundingRate mobile'>\n          <div className='index-prcie'>\n            Index: <span className={indexPriceClass}>&nbsp; <NumberFormat value={indexPrice.index} displayType='text'/></span>\n          </div>\n          <div className='funding-rate'>\n            <span>Funding: &nbsp;</span>\n            <span className='funding-per' title={fundingRateTip}>{ fundingRate }</span> \n          </div>\n        </div>\n      </div>\n      <div className={directionClazz}>\n        <div className='check-long' onClick={() => directionChange('long')}>LONG / BUY</div>\n        <div className='check-short' onClick={() => directionChange('short')}>SHORT / SELL</div>\n      </div>\n      <div className='the-input'>\n        <div className='left'>\n          <div className='current-position'>\n            <span>Current Position</span>\n            <span className='position-text'>{position.volume }</span>\n          </div>\n          <div className='contrant'>            \n            <input\n              type='number'\n              onFocus={onFocus}\n              onBlur={onBlur}\n              onKeyUp={onKeyUp}\n              disabled={!tradeInfo.available}\n              onChange={event =>  setVolume(direction === 'long' ? event.target.value : -event.target.value)}\n              value={tradeInfo.volume && Math.abs(tradeInfo.volume)}\n              className={volumeClazz}\n              placeholder='Contract Volume'\n            />\n            <div className='title-volume' >\n              Contract Volume\n            </div>\n          </div>          \n          {!!volume && <div className='btc'><NumberFormat value={tradeInfo.converted} allowNegative={false} displayType='text' decimalScale={4} prefix ='= ' suffix={` ${spec.unit}`}/></div>}\n        </div>\n        <div className='right-info'>\n          <div className='contrant-info'>\n            <div className='balance-contract'>\n              <span className='balance-contract-text pc'>\n                Balance in Contract<br/>\n                (Dynamic Balance)\n              </span>\n              <span className='balance-contract-text mobile'>\n                Balance in Contract<br/>\n                (Dyn Bal.)\n              </span>\n              <span className='balance-contract-num'>\n                <NumberFormat value={ tradeInfo.dynamicBalance } displayType='text' decimalScale={2}/>\n              </span>\n            </div>\n            <div className='box-margin'>\n              <span> Margin </span>\n              <span className='margin'>\n                <NumberFormat value={ tradeInfo.margin } allowNegative={false}  displayType='text' decimalScale={2}/>\n              </span>\n            </div>\n            <div className='available-balance'>\n              <span className='available-balance pc'> Available Balance </span>\n              <span className='available-balance mobile'>Avail Bal</span>\n              <span className='available-balance-num'>\n                <NumberFormat value={ tradeInfo.available } displayType='text' decimalScale={2} />\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className='slider mt-13'>\n        <Slider max={tradeInfo.dynamicBalance} freeze={freeze} onValueChange={onSlide} start={tradeInfo.margin}/>\n      </div>\n      <div className='title-margin'>Margin</div>\n      <div className='enterInfo'>\n        {!!volume && <>\n        <div className='text-info'>\n          <div className='title-enter pool'>Pool Liquidity</div>\n          <div className='text-enter poolL'>\n            <NumberFormat value={ poolLiquidity } decimalScale={2} suffix={` ${spec.bTokenSymbol}` } displayType='text'/> \n          </div>\n        </div>\n        <div className='text-info'>\n          <div className='title-enter'>Liquidity Used</div>\n          <div className='text-enter'>\n            <NumberFormat value={liqUsedPair.curLiqUsed} displayType='text' suffix='%'/> -> <NumberFormat value={ liqUsedPair.afterLiqUsed } displayType='text' decimalScale={2}  suffix='%'/>\n          </div>\n        </div>\n        <div className='text-info'>\n          <div className='title-enter'>Funding Rate Impact</div>\n          <div className='text-enter'>\n            <NumberFormat value={ fundingRate } displayType='text' suffix='%' allowNegative={false} decimalScale={4}/> -> <NumberFormat value={ fundingRateAfter } displayType='text' allowNegative={false} decimalScale={4} suffix='%' />\n          </div>\n        </div>\n        <div className='text-info'>\n          <div className='title-enter'>Transaction Fee</div>\n          <div className='text-enter'>\n            <NumberFormat value={ transFee } decimalScale={2} suffix={` ${spec.bTokenSymbol}` } displayType='text'/>             \n          </div>\n        </div>\n        </>}\n      </div>\n      <Operator hasConnectWallet={hasConnectWallet} \n                transFee={transFee} \n                wallet={wallet} \n                spec={spec} \n                indexPrice={indexPrice} \n                available={tradeInfo.available}\n                volume={volume} \n                direction={direction}\n                leverage={tradeInfo.leverage}\n                afterTrade={afterTrade}\n                position={position.volume}\n       />\n    </div>\n  </div>\n  )\n}\n\n\nconst ConfirmDialog = withModal(TradeConfirm)\nconst DepositDialog = withModal(DepositMargin)\n\nfunction Operator({hasConnectWallet,wallet,spec,volume,available,\n                  baseToken,leverage,indexPrice,position,direction,transFee,afterTrade}){\n  const [isApprove, setIsApprove] = useState(true);\n  const [noBalance, setNoBalance] = useState(false);\n  const [emptyVolume, setEmptyVolume] = useState(true);\n  const [modalIsOpen, setModalIsOpen] = useState(false);\n  const [balance, setBalance] = useState('');\n\n  \n  const connect = () => {\n    wallet.connect()\n  }\n\n  const approve = () => {\n    const {detail} = wallet\n    const res = unlock(detail.chainId,spec.pool,detail.account);\n    if(res.success){\n      setIsApprove(true);\n    } else {\n      alert(res.error)\n    }\n  }\n\n\n  const afterDeposit = async () => {    \n    onClose();\n    afterTrade()\n  }\n\n\n  //load Approve status\n  const loadApprove = async () => {\n    if(hasConnectWallet() && spec.pool){\n      const {detail} = wallet\n      const result = await isUnlocked(detail.chainId,spec.pool,detail.account).catch(e => console.log(e))\n      setIsApprove(result);\n    }\n  }\n\n  const loadBalance = async () => {\n    if(wallet.isConnected()){\n      const balance = await getWalletBalance(wallet.detail.chainId,spec.pool,wallet.detail.account)\n      if(balance){\n        setBalance(balance)\n      }\n    }\n  }\n\n  useEffect(() => {\n    loadBalance();\n    return () => {};\n  }, [wallet.detail.account]);\n\n  useEffect(() => {\n    if((+available) > 0){\n      setNoBalance(false)\n    } else {\n      setNoBalance(true)\n    }\n    return () => {\n    };\n  }, [available]);\n\n  useEffect(() => {\n    setEmptyVolume(!volume)\n    return () => {};\n  }, [volume]);\n\n\n  useEffect(() => {\n    loadApprove();\n    return () => {      \n    };\n  }, [spec.pool]);\n\n  const onClose = () => {\n    setModalIsOpen(false)\n  }\n  \n\n  let actionElement =(<>\n    <ConfirmDialog  wallet={wallet}\n                    spec={spec}\n                    modalIsOpen={modalIsOpen} \n                    onClose={onClose} \n                    leverage = {leverage} \n                    baseToken={baseToken} \n                    volume={volume} \n                    direction={direction} \n                    position={position} \n                    indexPrice={indexPrice.index} \n                    transFee={transFee}\n                    afterTrade={afterTrade}\n                    />\n    <button className='short-submit' onClick={() => setModalIsOpen(true)}>TRADE</button>\n  </>)\n\n  if(hasConnectWallet()){\n    if(!isApprove) {\n      actionElement = <Button className='approve' btnText='APPROVE' onClick={approve}/>\n    } else if(noBalance && available !== undefined) {\n      actionElement = (<>\n        <DepositDialog \n          wallet={wallet}\n          modalIsOpen={modalIsOpen} \n          onClose={onClose}\n          spec={spec}\n          balance={balance}\n          afterDeposit={afterDeposit}\n        />\n        <div className=\"noMargin-text\">You have no fund in contract. Please deposit first.</div>\n        <button className='short-submit'  onClick={() => setModalIsOpen(true)}>DEPOSIT</button>\n      </>)\n    } else if(emptyVolume) {\n      actionElement = <Button className='btn btn-danger short-submit' disabled btnText='ENTER VOLUME'/>\n    }\n  } else {\n    actionElement = <Button className='btn btn-danger connect' btnText='Connect Wallet' click={connect}/>\n  }\n  return (\n    <div className='submit-btn'>\n      {actionElement}        \n    </div>\n  )\n}","import React, { useState ,useEffect} from 'react'\nimport Button from \"../../Button/Button\";\nimport NumberFormat from 'react-number-format';\nimport { tradeWithMargin } from \"../../../lib/web3js\";\n\n\nexport default function TradeConfirm({wallet,spec,onClose,volume,direction,position = 0,indexPrice,leverage,transFee,afterTrade}){\n\n  const trade = async () => {\n    const res = await tradeWithMargin(wallet.detail.chainId,spec.pool,wallet.detail.account,volume)\n    if(res.success){\n      afterTrade()\n      onClose()\n    } else {\n      const msg = typeof res.error === 'string' ? res.error : res.error.errorMessage || res.error.message\n      alert(msg)\n    }\n  }\n\n\n  const afterTradePosition = ((+volume) + (+position))\n\n  return (\n    <div className='modal-dialog'>\n      <div className='modal-content'>\n        <div className='modal-header'>\n          <div className='title'>CONFIRM</div>\n          <div className='close' data-dismiss='modal' onClick={onClose}>\n            <span>&times;</span>\n          </div>\n        </div>\n        <div className='modal-body'>\n          <div className='contract-box-info'>\n            <div className='top'>\n              <div className='text'>\n                <div className='text-title'># of Contracts</div>\n                <div className='text-num'>{ volume }</div>\n              </div>\n              <div className='text'>\n                <div className='text-title'>Position after execution</div>\n                <div className='text-num'>{ afterTradePosition }</div>\n              </div>\n              <div className='text'>\n                <div className='text-title'>Direction</div>\n                <div className='text-num'><span className={direction}>{direction}</span></div>\n              </div>\n              <div className='text'>\n                <div className='text-title'>Trade Price (estimated)</div>\n                <div className='text-num'><NumberFormat value={ indexPrice } decimalScale={2}  displayType='text'/></div>\n              </div>\n              <div className='text'>\n                <div className='text-title'>Leverage after execution</div>\n                <div className='text-num'>{ leverage }X</div>\n              </div>\n              <div className='text'>\n                <div className='text-title'>Transaction Fee</div>\n                <div className='text-num'>\n                  <NumberFormat value={ transFee } decimalScale={2} suffix={` ${spec.bTokenSymbol}` } displayType='text'/>                   \n                </div>\n              </div>\n            </div>\n            <div className='modal-footer'>\n              <div className='long-btn' v-if='confirm'>\n                <button className='cancel' onClick={onClose}>CANCEL</button>\n                <Button className='confirm' btnText='OK' click={trade} />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","import { useState } from 'react'\nimport Position from './Position';\nimport History from './History';\nimport classNames from 'classnames';\nimport ContractInfo from '../ContractInfo/ContractInfo';\nimport Trade from './Trade';\n\nexport default function LiteTrade({wallet,specs,spec,onSpecChange,isPro,indexPrice}){\n  const [curTab, setCurTab] = useState('trade');\n\n  const switchTab = current => setCurTab(current);\n  const tradeClassName = classNames('trade-position',curTab)\n  return (\n      <div className={tradeClassName}>\n        <div className='header-top'>\n          <div className='header'>\n            <span className='trade' onClick={() => switchTab('trade')}>\n              TRADE\n            </span>\n            {!isPro && <>\n            <span\n              className='position' onClick={() => switchTab('position')}>\n              MY POSITION\n            </span>\n            <span className='history' onClick={() => switchTab('history')}>\n              HISTORY\n            </span>\n            </>}\n          </div>\n        </div>\n        <Trade wallet ={wallet}  spec={spec} specs={specs} indexPrice={indexPrice}  onSpecChange={onSpecChange}/>\n        <Position  wallet ={wallet} spec={spec}/>\n        <History wallet ={wallet} spec={spec} specs={specs} />\n        <ContractInfo wallet={wallet} spec={spec}/>   \n    </div> \n  )\n}","import React, { useState ,useEffect} from 'react'\nimport { withdrawMargin } from \"../../../lib/web3js\";\nimport NumberFormat from 'react-number-format';\nimport Button from '../../Button/Button';\n\nexport default function WithdrawMagin({wallet,spec = {},position,onClose,afterWithdraw}){\n  const [integer, setInteger] = useState('');\n  const [decimal, setDecimal] = useState('');\n  const [amount,setAmount] = useState('');\n\n  const calculateBalance = async () => {\n    if(wallet.isConnected()){      \n      if(position){\n        const balance = (+position.margin)  + (+position.unrealizedPnl) + ''       \n        const decimal = balance.substring(balance.indexOf('.') + 1,balance.indexOf('.') +3)\n        setInteger(balance);\n        setDecimal(decimal);\n      }\n    }\n  }\n\n  const removeAll = () => {\n    setAmount(integer)\n  }\n\n  const onChange = event => {\n    const {value} =event.target\n    setAmount(value)\n  }\n\n  const withdraw = async () => {\n    const res = await withdrawMargin(wallet.detail.chainId,spec.pool,wallet.detail.account,amount);\n    if(res.success){\n      afterWithdraw();\n    } else {\n      const msg = typeof res.error === 'string' ? res.error : res.error.errorMessage || res.error.message\n      alert(msg)\n    }\n  }\n\n  useEffect(() => {\n    calculateBalance();\n    return () => {\n    };\n  }, [wallet.detail.account,position.unrealizedPnl]);\n\n  return (\n    <div\n      className='modal fade'\n      id='removeMargin'\n    >\n      <div className='modal-dialog'>\n        <div className='modal-content'>\n          <div className='modal-header'>\n            <div className='title'>WITHDRAW MARGIN</div>\n            <div className='close' onClick={onClose}>\n              <span>&times;</span>\n            </div>\n          </div>\n          <div className='modal-body'>\n            <div className='margin-box-info'>\n              <div>Available Balance</div>\n              <div className='money'>\n                <span>\n                  <span className='bt-balance'>\n                    <NumberFormat value={ integer } thousandSeparator ={false} displayType = 'text' decimalScale={0}/>.<span style={{fontSize:'12px'}}>{decimal}</span>                     \n                  </span>\n                  </span>\n                <span className='remove'></span>\n              </div>\n              <div className='enter-margin remv'>\n                <div className='input-margin'>\n                  <div className='box'>\n                    <div className='amount' style={{display : amount !=='' ? 'block' : 'none'}}>AMOUNT</div>\n                    <input\n                      type='number'\n                      className='margin-value'\n                      value={amount}\n                      onChange={onChange}\n                      placeholder='Amount'/>\n                  </div>\n                </div>\n                <div>{ spec.baseToken }</div>\n              </div>\n              {(+position.volume) === 0 && <div className='max' v-show='isPosition'>\n                MAX: <span className='max-num'>{ integer }</span>\n                <span className='max-btn-left' onClick={removeAll}>REMOVE ALL</span>\n              </div>}\n              <div className='add-margin-btn'>\n                <Button className='margin-btn' btnText='WITHDRAW' click={withdraw}/>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"sourceRoot":""}