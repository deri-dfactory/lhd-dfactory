(this["webpackJsonpapp.deri.finance"]=this["webpackJsonpapp.deri.finance"]||[]).push([[2],{537:function(e,t,c){"use strict";c.d(t,"a",(function(){return o}));var a=c(0),n=c.n(a),s=c(1),i=c(15),r=c(3),l=c(35);function o(e){var t=e.btnText,c=e.className,a=e.disabled,o=e.click,d=e.afterClick,j=Object(r.useState)(a?"disabled":"enabled"),b=Object(i.a)(j,2),u=b[0],x=b[1],O=Object(r.useState)(!1),m=Object(i.a)(O,2),v=m[0],f=m[1],h=Object(r.useRef)(null),p=function(){var e=Object(s.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("enabled"===u){e.next=2;break}return e.abrupt("return");case 2:return x("disabled"),f(!0),h.current&&(h.current.style.display="inline-block"),e.next=7,o();case 7:e.sent&&d&&d(),h.current&&(h.current.style.display="none"),x("enabled"),f(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l.jsxs)("button",{className:c,onClick:p,children:[Object(l.jsx)("span",{className:"btn-loading-wrap",children:Object(l.jsx)("span",{ref:h,className:"spinner spinner-border spinner-border-sm",style:{display:"none",marginRight:"2"}})}),v?"PENDING":t]})}},538:function(e,t,c){"use strict";var a=c(91),n=c(4),s=c(5),i=c(10),r=c(9),l=c(3),o=c.n(l),d=c(542),j=c.n(d),b=c(35);t.a=function(e){var t=document.getElementById("root"),c={overlay:{position:"fixed",background:"none",zIndex:2},content:{position:"absolute",border:0,background:"none",inset:0,overflow:"initial"}};return function(l){Object(i.a)(d,l);var o=Object(r.a)(d);function d(e){var t;return Object(n.a)(this,d),(t=o.call(this,e)).state={modalIsOpen:!1},t}return Object(s.a)(d,[{key:"render",value:function(){var n=this.props.modalIsOpen;return Object(b.jsx)(j.a,{isOpen:n,style:c,appElement:t,children:Object(b.jsx)(e,Object(a.a)(Object(a.a)({},this.props),{},{onClose:this.props.onClose}))})}}]),d}(o.a.Component)}},539:function(e,t,c){"use strict";c.d(t,"a",(function(){return n}));var a=c(3);function n(e,t){var c=Object(a.useRef)(e);Object(a.useEffect)((function(){c.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){return c.current()}),t);return function(){return clearInterval(e)}}}),[t])}},548:function(e,t,c){"use strict";c.d(t,"a",(function(){return F}));var a=c(15),n=c(3),s=c(0),i=c.n(s),r=c(37),l=c(1),o=c(536),d=c(44),j=c(535),b=c.n(j),u=c(538),x=c(537),O=c(35);function m(e){var t=e.wallet,c=e.spec,s=void 0===c?{}:c,r=e.onClose,j=e.afterDeposit,b=Object(n.useState)(""),u=Object(a.a)(b,2),m=u[0],v=u[1],f=Object(n.useState)(""),h=Object(a.a)(f,2),p=h[0],N=h[1],g=Object(n.useState)(""),y=Object(a.a)(g,2),k=y[0],S=y[1],w=function(){var e=Object(l.a)(i.a.mark((function e(){var c,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isConnected()){e.next=5;break}return e.next=3,Object(d.y)(t.detail.chainId,s.pool,t.detail.account);case 3:(c=e.sent)&&(a=(+c).toFixed(2),n=a.substring(a.indexOf("."),a.length),v(c),N(n));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(i.a.mark((function e(c){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.f)(t.detail.chainId,s.pool,t.detail.account,c);case 2:(a=e.sent).success?(j(),r()):(n="string"===typeof a.error?a.error:a.error.errorMessage||a.error.message,alert(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return w(),function(){}}),[t.detail]),Object(O.jsx)("div",{className:"modal fade",children:Object(O.jsx)("div",{className:"modal-dialog",children:Object(O.jsxs)("div",{className:"modal-content",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("div",{className:"title",children:"DEPOSIT MARGIN"}),Object(O.jsx)("div",{className:"close","data-dismiss":"modal",onClick:r,children:Object(O.jsx)("span",{children:"\xd7"})})]}),Object(O.jsx)("div",{className:"modal-body",children:Object(O.jsxs)("div",{className:"margin-box-info",children:[Object(O.jsx)("div",{children:"Wallet Balance"}),Object(O.jsxs)("div",{className:"money",children:[Object(O.jsxs)("span",{children:[Object(O.jsxs)("span",{className:"bt-balance",children:[Object(O.jsx)(o.a,{value:m,displayType:"text",decimalScale:0}),".",Object(O.jsx)("span",{style:{fontSize:"12px"},children:p})]}),Object(O.jsx)("br",{}),Object(O.jsx)("span",{style:{fontSize:"14px",marginLeft:"10px",marginTop:"10px"},children:s.bTokenSymbol})]}),Object(O.jsx)("span",{className:"add"})]}),Object(O.jsxs)("div",{className:"enter-margin",children:[Object(O.jsx)("div",{className:"input-margin",children:Object(O.jsxs)("div",{className:"box",children:[Object(O.jsx)("div",{className:"amount",style:{display:""!==k?"block":"none"},children:"AMOUNT"}),Object(O.jsx)("input",{type:"number",className:"margin-value",placeholder:"Amount",value:k,onChange:function(e){var t=e.target.value;S(t)}})]})}),Object(O.jsx)("div",{children:s.bTokenSymbol})]}),Object(O.jsxs)("div",{className:"max",children:["MAX: ",Object(O.jsx)("span",{className:"max-num",children:m}),Object(O.jsx)("span",{className:"max-btn-left",onClick:function(){S(m)},children:"ADD ALL"})]}),Object(O.jsx)("div",{className:"add-margin-btn",children:Object(O.jsx)(x.a,{className:"margin-btn",btnText:"DEPOSIT",click:function(){return T(k)}})})]})})]})})})}var v=c(539),f=Object(u.a)(m),h=Object(u.a)((function(e){var t=e.wallet,c=e.spec,s=void 0===c?{}:c,r=e.onClose,j=e.afterWithdraw,b=Object(n.useState)(""),u=Object(a.a)(b,2),m=u[0],v=u[1],f=Object(n.useState)(""),h=Object(a.a)(f,2),p=h[0],N=h[1],g=Object(n.useState)(""),y=Object(a.a)(g,2),k=y[0],S=y[1],w=function(){var e=Object(l.a)(i.a.mark((function e(){var c,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isConnected()){e.next=5;break}return e.next=3,Object(d.q)(t.detail.chainId,s.pool,t.detail.account);case 3:(c=e.sent)&&(a=+c.margin+ +c.unrealizedPnl+"",n=a.substring(a.indexOf("."),a.indexOf(".")+3),v(a),N(n));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(i.a.mark((function e(){var c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.F)(t.detail.chainId,s.pool,t.detail.account,k);case 2:(c=e.sent).success?j():(a="string"===typeof c.error?c.error:c.error.errorMessage||c.error.message,alert(a));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return w(),function(){}}),[t.detail.account]),Object(O.jsx)("div",{className:"modal fade",id:"removeMargin",children:Object(O.jsx)("div",{className:"modal-dialog",children:Object(O.jsxs)("div",{className:"modal-content",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("div",{className:"title",children:"WITHDRAW MARGIN"}),Object(O.jsx)("div",{className:"close",onClick:r,children:Object(O.jsx)("span",{children:"\xd7"})})]}),Object(O.jsx)("div",{className:"modal-body",children:Object(O.jsxs)("div",{className:"margin-box-info",children:[Object(O.jsx)("div",{children:"Available Balance"}),Object(O.jsxs)("div",{className:"money",children:[Object(O.jsx)("span",{children:Object(O.jsxs)("span",{className:"bt-balance",children:[Object(O.jsx)(o.a,{value:m,thousandSeparator:!1,displayType:"text",decimalScale:0}),".",Object(O.jsx)("span",{style:{fontSize:"12px"},children:p})]})}),Object(O.jsx)("span",{className:"remove"})]}),Object(O.jsxs)("div",{className:"enter-margin remv",children:[Object(O.jsx)("div",{className:"input-margin",children:Object(O.jsxs)("div",{className:"box",children:[Object(O.jsx)("div",{className:"amount",style:{display:""!==k?"block":"none"},children:"AMOUNT"}),Object(O.jsx)("input",{type:"number",className:"margin-value",value:k,onChange:function(e){var t=e.target.value;S(t)},placeholder:"Amount"})]})}),Object(O.jsx)("div",{children:s.baseToken})]}),Object(O.jsxs)("div",{className:"max","v-show":"isPosition",children:["MAX: ",Object(O.jsx)("span",{className:"max-num",children:m}),Object(O.jsx)("span",{className:"max-btn-left",onClick:function(){S(m)},children:"REMOVE ALL"})]}),Object(O.jsx)("div",{className:"add-margin-btn",children:Object(O.jsx)(x.a,{className:"margin-btn",btnText:"WITHDRAW",click:T})})]})})]})})})}));function p(e){var t=e.wallet,c=e.spec,s=void 0===c?{}:c,j=Object(n.useState)(!1),u=Object(a.a)(j,2),x=u[0],m=u[1],p=Object(n.useState)({}),N=Object(a.a)(p,2),g=N[0],y=N[1],k=Object(n.useState)(""),S=Object(a.a)(k,2),w=S[0],T=S[1],C=Object(n.useState)(""),I=Object(a.a)(C,2),M=I[0],R=I[1],E=Object(n.useState)(!1),P=Object(a.a)(E,2),L=P[0],F=P[1],A=Object(n.useState)(!1),B=Object(a.a)(A,2),D=B[0],H=B[1];function z(){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(i.a.mark((function e(){var c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.isConnected()&&s&&s.pool)){e.next=5;break}return e.next=3,Object(d.q)(t.detail.chainId,s.pool,t.detail.account);case 3:(c=e.sent)&&(y(c),a=+c.volume>0?"LONG":0==c.volume?"--":"SHORT",T(a),R(+c.margin+ +c.unrealizedPnl));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(v.a)(z,3e3);var q=function(){var e=Object(l.a)(i.a.mark((function e(){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.next=3,Object(d.d)(t.detail.chainId,s.pool,t.detail.account).finally((function(){return m(!1)}));case 3:(c=e.sent).success?z():"string"===typeof c.error?alert(c.error):"object"===Object(r.a)(c.error)?alert(c.error.errorMessage):alert("Liquidation failed");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=b()("Direction","info-num",{LONG:"LONG"===w,SHORT:"SHORT"===w});return Object(n.useEffect)((function(){return z(),function(){}}),[t.detail.account,s.pool]),Object(O.jsxs)("div",{className:"position-info",children:[Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Position"}),Object(O.jsx)("div",{className:"info-num",children:g.volume})]}),Object(O.jsx)("div",{className:"info-right",children:Object(O.jsxs)("div",{className:"close-position",id:"close-p",onClick:q,children:[Object(O.jsx)("span",{className:"spinner spinner-border spinner-border-sm",role:"status","aria-hidden":"true",style:{display:x?"block":"none"}}),Object(O.jsx)("svg",{t:"1618369709897",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2009",width:"14",height:"14",children:Object(O.jsx)("path",{d:"M510.8096 420.3008l335.296-335.296 90.5088 90.5088-335.296 335.296 335.296 335.296-90.5088 90.5088-335.296-335.296-335.296 335.296-90.5088-90.5088 335.296-335.296-335.296-335.296 90.5088-90.5088z","p-id":"2010",fill:"#ffffff"})})," Close"]})})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Average Entry Price"}),Object(O.jsx)("div",{className:"info-num",children:Object(O.jsx)(o.a,{value:g.averageEntryPrice,decimalScale:2,displayType:"text"})})]}),Object(O.jsx)("div",{className:"info-right"})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text balance-con",children:"Balance in Contract (Dynamic Balance)"}),Object(O.jsxs)("div",{className:"info-num",children:[" ",Object(O.jsx)(o.a,{decimalScale:2,value:M,displayType:"text"})]})]}),Object(O.jsxs)("div",{className:"info-right",children:[Object(O.jsxs)("div",{className:"add-margin",id:"openAddMargin",onClick:function(){return F(!0)},children:[Object(O.jsx)("svg",{className:"svg",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",children:Object(O.jsx)("path",{id:"login",d:"M13,9,7,4V7H0v4H7v3Zm3,7H8v2h8a2.006,2.006,0,0,0,2-2V2a2.006,2.006,0,0,0-2-2H8V2h8Z",transform:"translate(18) rotate(90)",fill:"#3ebf38"})}),"Add"]}),Object(O.jsxs)("div",{className:"remove-margin",onClick:function(){return H(!0)},children:[Object(O.jsx)("svg",{className:"svg",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18",children:Object(O.jsx)("path",{id:"log-out","data-name":"log out",d:"M18,9,12,4V7H5v4h7v3ZM2,2h8V0H2A2.006,2.006,0,0,0,0,2V16a2.006,2.006,0,0,0,2,2h8V16H2Z",transform:"translate(0 18) rotate(-90)",fill:"#e35061"})}),"Remove"]})]})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Direction"}),Object(O.jsx)("div",{className:V,children:w})]}),Object(O.jsx)("div",{className:"info-right"})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Margin"}),Object(O.jsx)("div",{className:"info-num",children:Object(O.jsx)(o.a,{value:g.marginHeld,displayType:"text",decimalScale:2})})]}),Object(O.jsx)("div",{className:"info-right"})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Unrealized PnL"}),Object(O.jsx)("div",{className:"info-num",children:Object(O.jsx)(o.a,{value:g.unrealizedPnl,displayType:"text",decimalScale:8})})]}),Object(O.jsx)("div",{className:"info-right"})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsxs)("div",{className:"info-left",children:[Object(O.jsx)("div",{className:"title-text",children:"Liquidation Price"}),Object(O.jsx)("div",{className:"info-num",children:Object(O.jsx)(o.a,{decimalScale:2,value:g.liquidationPrice,displayType:"text"})})]}),Object(O.jsx)("div",{className:"info-right"})]}),Object(O.jsx)(f,{wallet:t,modalIsOpen:L,onClose:function(){F(!1)},spec:s,afterDeposit:function(){F(!1),z()}}),Object(O.jsx)(h,{wallet:t,modalIsOpen:D,onClose:function(){H(!1)},spec:s,afterWithdraw:function(){H(!1),z()}})]})}var N=c(552),g=c.n(N);function y(e){var t=e.wallet,c=void 0===t?{}:t,s=e.spec,r=void 0===s?{}:s,j=e.specs,b=void 0===j?[]:j,u=Object(n.useState)([]),x=Object(a.a)(u,2),m=x[0],v=x[1],f=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.u)(c.detail.chainId,r.pool,c.detail.account);case 2:t=e.sent,a=t.map((function(e){e.directionText="LONG"===e.direction?"LONG / BUY":"SHORT / SELL";var t=b.find((function(t){return t.bTokenSymbol===e.baseToken}));return t&&(e.baseTokenText=" ".concat(t.symbol," / ").concat(t.bTokenSymbol)),e})),v(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return f(),function(){}}),[c.detail,r.pool,b]),Object(O.jsx)("div",{className:"history-info","v-show":"historyShow",children:m.map((function(e,t){return Object(O.jsxs)("div",{className:"history-box",children:[Object(O.jsxs)("div",{className:"direction-bToken-price",children:[Object(O.jsxs)("span",{children:[Object(O.jsx)("span",{className:"".concat(e.direction),children:e.directionText}),Object(O.jsx)("span",{children:e.baseTokenText})]}),Object(O.jsx)("span",{className:"history-text time",children:g.a.asString("yyyy-MM-dd hh:mm:ss",new Date(parseInt(e.time)))})]}),Object(O.jsxs)("div",{className:"time-price-volume",children:[Object(O.jsxs)("div",{className:"history-price",children:[Object(O.jsx)("div",{className:"history-title",children:"Volume @ Price"}),Object(O.jsxs)("div",{className:"history-text",children:[e.volume," @ ",Object(O.jsx)(o.a,{value:e.price,decimalScale:2,displayType:"text"})]})]}),Object(O.jsxs)("div",{className:"notional",children:[Object(O.jsx)("div",{className:"history-title",children:"Notional"}),Object(O.jsx)("div",{className:"history-text",children:e.notional})]}),Object(O.jsxs)("div",{className:"history-fee",children:[Object(O.jsx)("div",{className:"history-title",children:"Transaction Fee"}),Object(O.jsx)("div",{className:"history-text",children:e.transactionFee})]})]})]},t)}))})}function k(e){var t=e.wallet,c=e.spec,s=void 0===c?{}:c,r=Object(n.useState)({bSymbol:"USDT",symbol:"BTCUSD",multiplier:"0.0001",fundingRateCoefficient:"0.0000025",minInitialMarginRatio:.1,minMaintenanceMarginRatio:5e-4,feeRatio:.05}),j=Object(a.a)(r,2),b=j[0],u=j[1];return Object(n.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.pool||!t.isConnected()){e.next=5;break}return e.next=3,Object(d.t)(t.detail.chainId,s.pool,t.detail.account);case 3:c=e.sent,u(c);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t&&e(),function(){}}),[s,t]),Object(O.jsxs)("div",{className:"contract-box",children:[Object(O.jsx)("div",{className:"contract-header"}),Object(O.jsxs)("div",{className:"contract-info",children:[Object(O.jsx)("div",{className:"conntract-header",children:"CONTRACT INFO"}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Base Token"}),Object(O.jsx)("div",{className:"text",children:b.bSymbol})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Symbol"}),Object(O.jsx)("div",{className:"text",children:b.symbol})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Multiplier"}),Object(O.jsx)("div",{className:"text",children:b.multiplier})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Funding Rate Coefficient"}),Object(O.jsx)("div",{className:"text",children:b.fundingRateCoefficient})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Min Initial Margin Ratio"}),Object(O.jsx)("div",{className:"text",children:Object(O.jsx)(o.a,{displayType:"text",value:100*b.minInitialMarginRatio,decimalScale:2,suffix:"%"})})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Min Maintenance Margin Ratio"}),Object(O.jsx)("div",{className:"text",children:Object(O.jsx)(o.a,{displayType:"text",value:100*b.minMaintenanceMarginRatio,decimalScale:2,suffix:"%"})})]}),Object(O.jsxs)("div",{className:"info",children:[Object(O.jsx)("div",{className:"title",children:"Transaction Fee"}),Object(O.jsx)("div",{className:"text",children:Object(O.jsx)(o.a,{displayType:"text",value:100*b.feeRatio,decimalScale:2,suffix:"%"})})]})]})]})}var S=c(91),w=c(556),T=c(587),C=(c(579),c(580),T.b.Handle);function I(e){var t=e.value,c=(e.dragging,e.index),a=Object(w.a)(e,["value","dragging","index"]);return Object(O.jsx)(T.a,{prefixCls:"rc-slider-tooltip",overlay:t||"",placement:"top",visible:!!t,overlayStyle:{display:"block"},overlayInnerStyle:{color:"#569BDA",background:"none",display:"block",fontSize:"10px",boxShadow:"none"},children:Object(O.jsx)(C,Object(S.a)({value:t},a))},c)}function M(e){var t=e.max,c=e.start,s=e.onValueChange,i=e.freeze,r=Object(n.useState)(0),l=Object(a.a)(r,2),o=l[0],d=l[1],j=Object(n.useState)(0),b=Object(a.a)(j,2),u=b[0],x=b[1],m=Object(n.useState)(!1),v=Object(a.a)(m,2),f=v[0],h=v[1],p=Object(n.useState)({}),N=Object(a.a)(p,2),g=N[0],y=N[1];return Object(n.useEffect)((function(){return h(i),function(){}}),[i]),Object(n.useEffect)((function(){if(isNaN(t))d("");else{h(!(+t>0));for(var e={},c=+t/10,a=0;a<=10;a++)if(0===a||10===a){var n={top:"-16px",position:"relative"};10===a&&(n.width=100,n.left="-10px",n.paddingRight="10px"),e[a*c]=Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{style:n,children:10===a?(a*c).toFixed(2):a*c}),Object(O.jsx)("div",{style:{top:"-16px",position:"relative"},children:"l"})]})}else e[a*c]="l";y(e),d(+t)}return function(){}}),[t]),Object(n.useEffect)((function(){return isNaN(c)?x(0):x(c),function(){}}),[c]),Object(O.jsx)(T.b,{handle:I,className:"deri-slider",start:c,min:0,max:o,value:u,onChange:function(e){x(e),s(e)},disabled:f,overlay:u,step:.01,marks:g})}function R(e){var t=e.wallet,c=void 0===t?{}:t,s=e.spec,r=void 0===s?{}:s,j=e.specs,u=void 0===j?[]:j,x=e.onSpecChange,m=e.indexPrice,f=Object(n.useState)("long"),h=Object(a.a)(f,2),p=h[0],N=h[1],g=Object(n.useState)(null),y=Object(a.a)(g,2),k=y[0],w=y[1],T=Object(n.useState)(!1),C=Object(a.a)(T,2),I=C[0],R=C[1],E=Object(n.useState)("0.00"),P=Object(a.a)(E,2),F=P[0],A=P[1],B=Object(n.useState)({}),D=Object(a.a)(B,2),H=D[0],z=D[1],U=Object(n.useState)("0.00"),q=Object(a.a)(U,2),V=q[0],W=q[1],G=Object(n.useState)(""),X=Object(a.a)(G,2),Y=X[0],Z=X[1],J=Object(n.useState)(""),K=Object(a.a)(J,2),$=K[0],Q=K[1],_=Object(n.useState)(""),ee=Object(a.a)(_,2),te=ee[0],ce=ee[1],ae=Object(n.useState)(""),ne=Object(a.a)(ae,2),se=ne[0],ie=ne[1],re=Object(n.useState)({}),le=Object(a.a)(re,2),oe=le[0],de=le[1],je=Object(n.useState)(""),be=Object(a.a)(je,2),ue=be[0],xe=be[1],Oe=Object(n.useState)(!1),me=Object(a.a)(Oe,2),ve=me[0],fe=me[1],he=Object(n.useRef)(),pe=Object(n.useState)({}),Ne=Object(a.a)(pe,2),ge=Ne[0],ye=Ne[1],ke=Object(n.useState)(""),Se=Object(a.a)(ke,2),we=Se[0],Te=Se[1];Object(v.a)(Ae,3e3);var Ce=b()("checked-long","check-long-short"," long-short",{" checked-short":"short"===p}),Ie=b()("dropdown-menu",{show:I}),Me=b()("contrant-input",{inputFamliy:""!==we}),Re=function(){return r&&r.pool},Ee=function(){return c&&c.detail&&c.detail.account},Pe=function(e){Te(""),N(e)},Le=function(e){u.length>0&&(e.stopPropagation(),R(!I))},Fe=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=5;break}return e.next=3,Object(d.l)(c.detail.chainId,r.pool);case 3:(t=e.sent)&&(W(t.fundingRate0),a="Funding  Rate (per block) = ".concat(t.fundingRatePerBlock)+"\n(1 Long contract pays 1 short contract ".concat(t.fundingRatePerBlock," ").concat(r.bTokenSymbol," per block)"),Z(a),ie(t.liquidity));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Ae(){return Be.apply(this,arguments)}function Be(){return(Be=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=5;break}return e.next=3,Object(d.q)(c.detail.chainId,r.pool,c.detail.account);case 3:(t=e.sent)&&z(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=5;break}return e.next=3,Object(d.t)(c.detail.chainId,r.pool,c.detail.account);case 3:t=e.sent,w(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=5;break}return e.next=3,Object(d.i)(c.detail.chainId,r.pool,Math.abs(we));case 3:t=e.sent,ce(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=9;break}return t=c.detail,e.next=4,Object(d.n)(t.chainId,r.pool);case 4:return a=e.sent,e.next=7,Object(d.k)(t.chainId,r.pool,we);case 7:n=e.sent,a&&n&&de({curLiqUsed:a.liquidityUsed0,afterLiqUsed:n.liquidityUsed1});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ee()||!Re()){e.next=5;break}return e.next=3,Object(d.j)(c.detail.chainId,r.pool,we);case 3:(t=e.sent)&&Q(t.fundingRate1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qe=function(){!function(){if(Ee()&&Re()){var e=c.detail,t=e.chainId,a=e.account,n=r.pool;d.B.clear(),d.B.update(t,n),d.b.update(t,n,a)}}(),Fe(),Ae(),De()};return Object(n.useEffect)((function(){var e=document.body.addEventListener("click",(function(){return R(!1)}),!1);return function(){document.body.removeEventListener("click",e)}}),[]),Object(n.useEffect)((function(){return qe(),function(){}}),[c.detail,r]),Object(n.useEffect)((function(){return function(){if(H&&k&&m){var e=+we+ +H.volume,t=Math.abs(e)*m.index*k.multiplier,c=(+H.margin+ +H.unrealizedPnl).toFixed(2),a=(t*k.minInitialMarginRatio).toFixed(2),n=(+t/+c).toFixed(1),s=+c-+a,i=t/m.index,r={volume:we,dynamicBalance:c,margin:a,marginHeld:H.marginHeld,available:s,converted:i,leverage:n};ye(r)}}(),he.current&&xe(he.current>m.index?"fall":"rise"),he.current=m.index,function(){}}),[H.unrealizedPnl,H.volume,m.index,we]),Object(n.useEffect)((function(){return Ue(),ze(),He(),function(){}}),[we]),Object(n.useEffect)((function(){if(k){var e=+F/(+m.index*+k.multiplier*+k.minInitialMarginRatio)-+H.volume;if(!isNaN(e)){var t=Math.floor(e);N(t>=0?"long":"short");var c=Object(S.a)({},ge);c.volume=t,ye(c),Te(t)}}return function(){}}),[F]),Object(O.jsx)("div",{className:"trade-info",children:Object(O.jsxs)("div",{className:"trade-peration",children:[Object(O.jsxs)("div",{className:"check-baseToken",children:[Object(O.jsxs)("div",{className:"btn-group check-baseToken-btn",children:[Object(O.jsxs)("button",{type:"button",onClick:Le,className:"btn chec",children:[r.symbol," / ",r.bTokenSymbol," (10X)",Object(O.jsx)("span",{className:"check-base-down",onClick:Le,children:Object(O.jsx)("svg",{t:"1616752321986",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1700",width:"16",height:"16",children:Object(O.jsx)("path",{d:"M843.946667 285.866667L512 617.386667 180.053333 285.866667 119.893333 346.026667l331.946667 331.946666L512 738.133333l392.106667-392.106666-60.16-60.16z","p-id":"1701",fill:"#cccccc"})})})]}),Object(O.jsx)("div",{className:Ie,children:Object(O.jsx)("div",{className:"dropdown-box",children:u.map((function(e,t){return Object(O.jsxs)("div",{className:"dropdown-item",onClick:function(t){return function(e){var t=u.find((function(t){return t.symbol===e.symbol}));fe(!0),x(t),Te(""),fe(!1)}(e)},children:[e.symbol," / ",e.bTokenSymbol," (10X)"]},t)}))})})]}),Object(O.jsxs)("div",{className:"price-fundingRate pc",children:[Object(O.jsxs)("div",{className:"index-prcie",children:["Index Price: ",Object(O.jsxs)("span",{className:ue,children:["\xa0 ",Object(O.jsx)(o.a,{value:m.index,displayType:"text"})]})]}),Object(O.jsxs)("div",{className:"funding-rate",children:[Object(O.jsx)("span",{children:"Funding Rate Annual: \xa0"}),Object(O.jsx)("span",{className:"funding-per",title:Y,children:V})]})]}),Object(O.jsxs)("div",{className:"price-fundingRate mobile",children:[Object(O.jsxs)("div",{className:"index-prcie",children:["Index: ",Object(O.jsxs)("span",{className:ue,children:["\xa0 ",Object(O.jsx)(o.a,{value:m.index,displayType:"text"})]})]}),Object(O.jsxs)("div",{className:"funding-rate",children:[Object(O.jsx)("span",{children:"Funding: \xa0"}),Object(O.jsx)("span",{className:"funding-per",title:Y,children:V})]})]})]}),Object(O.jsxs)("div",{className:Ce,children:[Object(O.jsx)("div",{className:"check-long",onClick:function(){return Pe("long")},children:"LONG / BUY"}),Object(O.jsx)("div",{className:"check-short",onClick:function(){return Pe("short")},children:"SHORT / SELL"})]}),Object(O.jsxs)("div",{className:"the-input",children:[Object(O.jsxs)("div",{className:"left",children:[Object(O.jsxs)("div",{className:"current-position",children:[Object(O.jsx)("span",{children:"Current Position"}),Object(O.jsx)("span",{className:"position-text",children:H.volume})]}),Object(O.jsxs)("div",{className:"contrant",children:[Object(O.jsx)("input",{type:"number",onFocus:function(e){e.target.setAttribute("class","contrant-input inputFamliy")},onBlur:function(e){var t=e.target;""===t.value&&t.setAttribute("class","contrant-input")},onKeyUp:function(e){return""!==e.target.value&&/^\d*\.?\d*$/.test(e.target.value)},disabled:!ge.available,onChange:function(e){return Te("long"===p?e.target.value:-e.target.value)},value:ge.volume&&Math.abs(ge.volume),className:Me,placeholder:"Contract Volume"}),Object(O.jsx)("div",{className:"title-volume",children:"Contract Volume"})]}),!!we&&Object(O.jsx)("div",{className:"btc",children:Object(O.jsx)(o.a,{value:ge.converted,allowNegative:!1,displayType:"text",decimalScale:4,prefix:"= ",suffix:" ".concat(r.unit)})})]}),Object(O.jsx)("div",{className:"right-info",children:Object(O.jsxs)("div",{className:"contrant-info",children:[Object(O.jsxs)("div",{className:"balance-contract",children:[Object(O.jsxs)("span",{className:"balance-contract-text pc",children:["Balance in Contract",Object(O.jsx)("br",{}),"(Dynamic Balance)"]}),Object(O.jsxs)("span",{className:"balance-contract-text mobile",children:["Balance in Contract",Object(O.jsx)("br",{}),"(Dyn Bal.)"]}),Object(O.jsx)("span",{className:"balance-contract-num",children:Object(O.jsx)(o.a,{value:ge.dynamicBalance,displayType:"text",decimalScale:2})})]}),Object(O.jsxs)("div",{className:"box-margin",children:[Object(O.jsx)("span",{children:" Margin "}),Object(O.jsx)("span",{className:"margin",children:Object(O.jsx)(o.a,{value:ge.margin,allowNegative:!1,displayType:"text",decimalScale:2})})]}),Object(O.jsxs)("div",{className:"available-balance",children:[Object(O.jsx)("span",{className:"available-balance pc",children:" Available Balance "}),Object(O.jsx)("span",{className:"available-balance mobile",children:"Avail Bal"}),Object(O.jsx)("span",{className:"available-balance-num",children:Object(O.jsx)(o.a,{value:ge.available,displayType:"text",decimalScale:2})})]})]})})]}),Object(O.jsx)("div",{className:"slider mt-13",children:Object(O.jsx)(M,{max:ge.dynamicBalance,freeze:ve,onValueChange:function(e){A(e)},start:ge.margin})}),Object(O.jsx)("div",{className:"title-margin",children:"Margin"}),Object(O.jsx)("div",{className:"enterInfo",children:!!we&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"text-info",children:[Object(O.jsx)("div",{className:"title-enter pool",children:"Pool Liquidity"}),Object(O.jsx)("div",{className:"text-enter poolL",children:Object(O.jsx)(o.a,{value:se,decimalScale:2,suffix:" ".concat(r.bTokenSymbol),displayType:"text"})})]}),Object(O.jsxs)("div",{className:"text-info",children:[Object(O.jsx)("div",{className:"title-enter",children:"Liquidity Used"}),Object(O.jsxs)("div",{className:"text-enter",children:[Object(O.jsx)(o.a,{value:oe.curLiqUsed,displayType:"text",suffix:"%"})," -> ",Object(O.jsx)(o.a,{value:oe.afterLiqUsed,displayType:"text",decimalScale:2,suffix:"%"})]})]}),Object(O.jsxs)("div",{className:"text-info",children:[Object(O.jsx)("div",{className:"title-enter",children:"Funding Rate Impact"}),Object(O.jsxs)("div",{className:"text-enter",children:[Object(O.jsx)(o.a,{value:V,displayType:"text",allowNegative:!1,decimalScale:4})," -> ",Object(O.jsx)(o.a,{value:$,displayType:"text",allowNegative:!1,decimalScale:4})]})]}),Object(O.jsxs)("div",{className:"text-info",children:[Object(O.jsx)("div",{className:"title-enter",children:"Transaction Fee"}),Object(O.jsx)("div",{className:"text-enter",children:Object(O.jsx)(o.a,{value:te,decimalScale:2,suffix:" ".concat(r.bTokenSymbol),displayType:"text"})})]})]})}),Object(O.jsx)(L,{hasConnectWallet:Ee,transFee:te,wallet:c,spec:r,indexPrice:m,available:ge.available,volume:we,direction:p,leverage:ge.leverage,afterTrade:function(){Te(""),Ae()},position:H.volume})]})})}var E=Object(u.a)((function(e){var t=e.wallet,c=e.spec,a=e.onClose,n=e.volume,s=e.direction,r=e.position,j=void 0===r?0:r,b=e.indexPrice,u=e.leverage,m=e.transFee,v=e.afterTrade,f=function(){var e=Object(l.a)(i.a.mark((function e(){var s,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.D)(t.detail.chainId,c.pool,t.detail.account,n);case 2:(s=e.sent).success?(v(),a()):(r="string"===typeof s.error?s.error:s.error.errorMessage||s.error.message,alert(r));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=+n+ +j;return Object(O.jsx)("div",{className:"modal-dialog",children:Object(O.jsxs)("div",{className:"modal-content",children:[Object(O.jsxs)("div",{className:"modal-header",children:[Object(O.jsx)("div",{className:"title",children:"CONFIRM"}),Object(O.jsx)("div",{className:"close","data-dismiss":"modal",onClick:a,children:Object(O.jsx)("span",{children:"\xd7"})})]}),Object(O.jsx)("div",{className:"modal-body",children:Object(O.jsxs)("div",{className:"contract-box-info",children:[Object(O.jsxs)("div",{className:"top",children:[Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"# of Contracts"}),Object(O.jsx)("div",{className:"text-num",children:n})]}),Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"Position after execution"}),Object(O.jsx)("div",{className:"text-num",children:h})]}),Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"Direction"}),Object(O.jsx)("div",{className:"text-num",children:Object(O.jsx)("span",{className:s,children:s})})]}),Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"Trade Price (estimated)"}),Object(O.jsx)("div",{className:"text-num",children:Object(O.jsx)(o.a,{value:b,decimalScale:2,displayType:"text"})})]}),Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"Leverage after execution"}),Object(O.jsxs)("div",{className:"text-num",children:[u,"X"]})]}),Object(O.jsxs)("div",{className:"text",children:[Object(O.jsx)("div",{className:"text-title",children:"Transaction Fee"}),Object(O.jsx)("div",{className:"text-num",children:Object(O.jsx)(o.a,{value:m,decimalScale:2,suffix:" ".concat(c.bTokenSymbol),displayType:"text"})})]})]}),Object(O.jsx)("div",{className:"modal-footer",children:Object(O.jsxs)("div",{className:"long-btn","v-if":"confirm",children:[Object(O.jsx)("button",{className:"cancel",onClick:a,children:"CANCEL"}),Object(O.jsx)(x.a,{className:"confirm",btnText:"OK",click:f})]})})]})})]})})})),P=Object(u.a)(m);function L(e){var t=e.hasConnectWallet,c=e.wallet,s=e.spec,r=e.volume,o=e.available,j=e.baseToken,b=e.leverage,u=e.indexPrice,m=e.position,v=e.direction,f=e.transFee,h=e.afterTrade,p=Object(n.useState)(!0),N=Object(a.a)(p,2),g=N[0],y=N[1],k=Object(n.useState)(!1),S=Object(a.a)(k,2),w=S[0],T=S[1],C=Object(n.useState)(!0),I=Object(a.a)(C,2),M=I[0],R=I[1],L=Object(n.useState)(!1),F=Object(a.a)(L,2),A=F[0],B=F[1],D=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:z(),h();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(l.a)(i.a.mark((function e(){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t()||!s.pool){e.next=6;break}return a=c.detail,e.next=4,Object(d.z)(a.chainId,s.pool,a.account).catch((function(e){return console.log(e)}));case 4:n=e.sent,y(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){return T(!(+o>0)),function(){}}),[o]),Object(n.useEffect)((function(){return R(!r),function(){}}),[r]),Object(n.useEffect)((function(){return H(),function(){}}),[s.pool]);var z=function(){B(!1)},U=Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(E,{wallet:c,spec:s,modalIsOpen:A,onClose:z,leverage:b,baseToken:j,volume:r,direction:v,position:m,indexPrice:u.index,transFee:f,afterTrade:h}),Object(O.jsx)("button",{className:"short-submit",onClick:function(){return B(!0)},children:"TRADE"})]});return t()?g?w&&void 0!==o?U=Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(P,{wallet:c,modalIsOpen:A,onClose:z,spec:s,afterDeposit:D}),Object(O.jsx)("div",{className:"noMargin-text",children:"You\xa0have\xa0no\xa0fund\xa0in\xa0contract.\xa0Please\xa0deposit\xa0first."}),Object(O.jsx)("button",{className:"short-submit",onClick:function(){return B(!0)},children:"DEPOSIT"})]}):M&&(U=Object(O.jsx)(x.a,{className:"btn btn-danger short-submit",disabled:!0,btnText:"ENTER VOLUME"})):U=Object(O.jsx)(x.a,{className:"approve",btnText:"APPROVE",onClick:function(){var e=c.detail,t=Object(d.E)(e.chainId,s.pool,e.account);t.success?y(!0):alert(t.error)}}):U=Object(O.jsx)(x.a,{className:"btn btn-danger connect",btnText:"Connect Wallet",click:function(){c.connect()}}),Object(O.jsx)("div",{className:"submit-btn",children:U})}function F(e){var t=e.wallet,c=e.specs,s=e.spec,i=e.onSpecChange,r=e.isPro,l=e.indexPrice,o=Object(n.useState)("trade"),d=Object(a.a)(o,2),j=d[0],u=d[1],x=function(e){return u(e)},m=b()("trade-position",j);return Object(O.jsxs)("div",{className:m,children:[Object(O.jsx)("div",{className:"header-top",children:Object(O.jsxs)("div",{className:"header",children:[Object(O.jsx)("span",{className:"trade",onClick:function(){return x("trade")},children:"TRADE"}),!r&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("span",{className:"position",onClick:function(){return x("position")},children:"MY POSITION"}),Object(O.jsx)("span",{className:"history",onClick:function(){return x("history")},children:"HISTORY"})]})]})}),Object(O.jsx)(R,{wallet:t,spec:s,specs:c,indexPrice:l,onSpecChange:i}),Object(O.jsx)(p,{wallet:t,spec:s}),Object(O.jsx)(y,{wallet:t,spec:s,specs:c}),Object(O.jsx)(k,{wallet:t,spec:s})]})}},580:function(e,t,c){}}]);
//# sourceMappingURL=2.b31823f9.chunk.js.map